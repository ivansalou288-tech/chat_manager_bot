# üé∞ –ú–æ–¥—É–ª—å Kasik (–ö–∞–∑–∏–Ω–æ) - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 20.12.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ production  
**–Ø–∑—ã–∫:** Python 3.10+  

---

## üìñ –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å Kasik (`modules/kasik.py`) —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∫–∞–∑–∏–Ω–æ —Å –∏–≥—Ä–æ–≤—ã–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∞–º–∏ (—Å–ª–æ—Ç–∞–º–∏). –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å—Ç–∞–≤—è—Ç –∫–æ–∏–Ω—ã –∏–∑ —Ñ–∞—Ä–º—ã –∏ –ø—ã—Ç–∞—é—Ç—Å—è –≤—ã–∏–≥—Ä–∞—Ç—å. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –∫—É–ª–¥–∞—É–Ω 15 –º–∏–Ω—É—Ç, –ø—Ä–æ–≤–µ—Ä–∫—É –±–∞–ª–∞–Ω—Å–∞ –∏ –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ **–í—ã–±–æ—Ä —Å—Ç–∞–≤–∫–∏** - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ —Å—Ç–∞–≤–æ–∫  
‚úÖ **–ö—É–ª–¥–∞—É–Ω 15 –º–∏–Ω—É—Ç** - –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞  
‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–æ–∏–Ω–æ–≤  
‚úÖ **–°–ª–æ—Ç-–º–∞—à–∏–Ω—ã** - 3 –±–∞—Ä–∞–±–∞–Ω–∞ —Å —Å–∏–º–≤–æ–ª–∞–º–∏  
‚úÖ **–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** - –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ä–∞—â–µ–Ω–∏—è  
‚úÖ **–ú—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä—ã** - —Ä–∞–∑–Ω—ã–µ –≤—ã–∏–≥—Ä—ã—à–∏ –∑–∞ —Ä–∞–∑–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏  
‚úÖ **–ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –ë–î  

---

## üéØ –û—Å–Ω–æ–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫

### kasik()

–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∫–∞–∑–∏–Ω–æ.

```python
@dp.message_handler(Text(startswith=['! –∫–∞–∑–∏–∫', '!–∫–∞–∑–∏–∫'], ignore_case=True))
async def kasik(message: types.Message):
    """
    –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–∞–∑–∏–Ω–æ —Å –≤—ã–±–æ—Ä–æ–º —Å—Ç–∞–≤–∫–∏
    """
```

**–°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–≥–¥–∞:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–ø–∏—à–µ—Ç `!–∫–∞–∑–∏–∫` –∏–ª–∏ `! –∫–∞–∑–∏–∫`

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —ç—Ç–æ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—É–ª–¥–∞—É–Ω (15 –º–∏–Ω—É—Ç —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç–∞–≤–∫–∏)
3. –ü–æ–ª—É—á–∞–µ—Ç –±–∞–ª–∞–Ω—Å –º–µ—à–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Å—Ç–∞–≤–∫–∏
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ä–∞–∑–º–µ—Ä —Å—Ç–∞–≤–∫–∏ (–≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 10 –¥–æ –µ–≥–æ –±–∞–ª–∞–Ω—Å–∞)
6. –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Å—Ç–∞–≤–∫–∏ –≤—Ä–∞—â–∞—é—Ç—Å—è —Å–ª–æ—Ç—ã
7. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–æ–∏–Ω—ã

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `stavki` (–≤ kasik.db)

```sql
CREATE TABLE IF NOT EXISTS stavki (
    user_id INTEGER PRIMARY KEY,
    last_date TEXT
)
```

### –¢–∞–±–ª–∏—Ü–∞ `kasik_history` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```sql
CREATE TABLE IF NOT EXISTS kasik_history (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    chat_id INTEGER NOT NULL,
    stake INTEGER NOT NULL,
    result TEXT NOT NULL,
    winnings INTEGER NOT NULL,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)
```

---

## üíª –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞ –∫–∞–∑–∏–Ω–æ

```python
def can_play_kasik(user_id: int, db_path: str) -> tuple[bool, str]:
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –º–æ–∂–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–≥—Ä–∞—Ç—å –≤ –∫–∞–∑–∏–Ω–æ"""
    connection = sqlite3.connect(db_path, check_same_thread=False)
    cursor = connection.cursor()
    
    try:
        last_date_str = cursor.execute(
            "SELECT last_date FROM stavki WHERE user_id = ?",
            (user_id,)
        ).fetchone()[0]
        
        last_date = datetime.strptime(last_date_str, "%H:%M:%S %d.%m.%Y")
        now = datetime.now()
        delta = now - last_date
        
        if delta >= timedelta(minutes=15):
            return True, "–ú–æ–∂–µ—Ç–µ –∏–≥—Ä–∞—Ç—å"
        else:
            remaining = timedelta(minutes=15) - delta
            minutes = remaining.seconds // 60
            seconds = remaining.seconds % 60
            return False, f"–ü–æ–¥–æ–∂–¥–∏—Ç–µ {minutes}:{seconds:02d}"
    except (IndexError, TypeError):
        return True, "–ü–µ—Ä–≤–∞—è —Å—Ç–∞–≤–∫–∞"
    finally:
        connection.close()
```

### –ü—Ä–∏–º–µ—Ä 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å–ª–æ—Ç–æ–≤

```python
SLOT_SYMBOLS = {
    "üçä": 10,
    "üçã": 20,
    "üçí": 30,
    "‚≠ê": 50,
    "üíé": 100
}

def generate_slot_result() -> tuple[str, str, str, int]:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–ª–æ—Ç–æ–≤"""
    symbols = list(SLOT_SYMBOLS.keys())
    
    slot1 = random.choice(symbols)
    slot2 = random.choice(symbols)
    slot3 = random.choice(symbols)
    
    # –†–∞—Å—á—ë—Ç –≤—ã–∏–≥—Ä—ã—à–∞
    if slot1 == slot2 == slot3:
        # –í—Å–µ —Ç—Ä–∏ —Å–∏–º–≤–æ–ª–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç - –±–æ–ª—å—à–æ–π –≤—ã–∏–≥—Ä—ã—à
        multiplier = 10
    elif slot1 == slot2 or slot2 == slot3:
        # –î–≤–∞ —Å–∏–º–≤–æ–ª–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç
        multiplier = 3
    else:
        # –ù–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
        multiplier = 0
    
    return slot1, slot2, slot3, multiplier

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
slot1, slot2, slot3, multiplier = generate_slot_result()
print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {slot1} {slot2} {slot3}")
print(f"–ú–Ω–æ–∂–∏—Ç–µ–ª—å: {multiplier}x")

stake = 100
winnings = stake * multiplier
print(f"–í—ã–∏–≥—Ä—ã—à: {winnings} –∫–æ–∏–Ω–æ–≤")
```

### –ü—Ä–∏–º–µ—Ä 3: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å—Ç–∞–≤–∫–∏

```python
def save_kasik_result(user_id: int, chat_id: int, stake: int, 
                      result: str, winnings: int, db_path: str) -> bool:
    """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ç–∞–≤–∫–∏ –≤ –∏—Å—Ç–æ—Ä–∏—é"""
    connection = sqlite3.connect(db_path, check_same_thread=False)
    cursor = connection.cursor()
    
    try:
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS kasik_history (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                user_id INTEGER NOT NULL,
                chat_id INTEGER NOT NULL,
                stake INTEGER NOT NULL,
                result TEXT NOT NULL,
                winnings INTEGER NOT NULL,
                timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        cursor.execute(
            '''INSERT INTO kasik_history (user_id, chat_id, stake, result, winnings)
               VALUES (?, ?, ?, ?, ?)''',
            (user_id, chat_id, stake, result, winnings)
        )
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞—Ç—É –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç–∞–≤–∫–∏
        cursor.execute(
            "INSERT OR REPLACE INTO stavki (user_id, last_date) VALUES (?, ?)",
            (user_id, datetime.now().strftime("%H:%M:%S %d.%m.%Y"))
        )
        
        connection.commit()
        return True
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞: {e}")
        return False
    finally:
        connection.close()
```

### –ü—Ä–∏–º–µ—Ä 4: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–∞–∑–∏–Ω–æ

```python
def get_kasik_stats(user_id: int, db_path: str) -> dict:
    """–ü–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–≥—Ä–æ–∫–∞ –≤ –∫–∞–∑–∏–Ω–æ"""
    connection = sqlite3.connect(db_path, check_same_thread=False)
    cursor = connection.cursor()
    
    try:
        # –í—Å–µ–≥–æ —Å—Ç–∞–≤–æ–∫
        total_bets = cursor.execute(
            "SELECT COUNT(*) FROM kasik_history WHERE user_id = ?",
            (user_id,)
        ).fetchone()[0]
        
        # –í—Å–µ–≥–æ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–æ
        total_staked = cursor.execute(
            "SELECT SUM(stake) FROM kasik_history WHERE user_id = ?",
            (user_id,)
        ).fetchone()[0] or 0
        
        # –í—Å–µ–≥–æ –≤—ã–∏–≥—Ä–∞–Ω–æ
        total_winnings = cursor.execute(
            "SELECT SUM(winnings) FROM kasik_history WHERE user_id = ?",
            (user_id,)
        ).fetchone()[0] or 0
        
        # –ë–∞–ª–∞–Ω—Å
        balance = total_winnings - total_staked
        
        return {
            "total_bets": total_bets,
            "total_staked": total_staked,
            "total_winnings": total_winnings,
            "balance": balance,
            "roi": (balance / total_staked * 100) if total_staked > 0 else 0
        }
    finally:
        connection.close()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
stats = get_kasik_stats(123456, "kasik.db")
print(f"–í—Å–µ–≥–æ —Å—Ç–∞–≤–æ–∫: {stats['total_bets']}")
print(f"–í—ã–∏–≥—Ä—ã—à/–ø—Ä–æ–∏–≥—Ä—ã—à: {stats['balance']}")
print(f"ROI: {stats['roi']:.2f}%")
```

---

## üöÄ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –ò–¥–µ—è 1: –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –¥–∂–µ–∫–ø–æ—Ç

```python
class ProgressiveJackpot:
    def __init__(self, initial: int = 1000):
        self.base_amount = initial
        self.current = initial
    
    def add_to_jackpot(self, amount: int):
        """–î–æ–±–∞–≤–ª—è–µ—Ç —Å—É–º–º—É –≤ –¥–∂–µ–∫–ø–æ—Ç"""
        self.current += amount
    
    def win_jackpot(self) -> int:
        """–í—ã–∏–≥—Ä—ã–≤–∞–µ—Ç –¥–∂–µ–∫–ø–æ—Ç –∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç"""
        won = self.current
        self.current = self.base_amount
        return won
    
    def get_jackpot(self) -> int:
        """–ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä –¥–∂–µ–∫–ø–æ—Ç–∞"""
        return self.current

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
jackpot = ProgressiveJackpot()
jackpot.add_to_jackpot(100)  # –ö–∞–∂–¥–∞—è —Å—Ç–∞–≤–∫–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ –¥–∂–µ–∫–ø–æ—Ç
if lucky:
    won_amount = jackpot.win_jackpot()
```

### –ò–¥–µ—è 2: –ë–æ–Ω—É—Å-—Ä–∞—É–Ω–¥—ã –∏ –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä—ã

```python
def calculate_bonus_multiplier(bet_count: int) -> float:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–æ–Ω—É—Å–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–∞–≤–æ–∫ –ø–æ–¥—Ä—è–¥"""
    if bet_count < 5:
        return 1.0
    elif bet_count < 10:
        return 1.1  # +10%
    elif bet_count < 20:
        return 1.2  # +20%
    else:
        return 1.3  # +30%

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
multiplier = calculate_bonus_multiplier(15)
final_winnings = int(base_winnings * multiplier)
```

### –ò–¥–µ—è 3: –°–∏—Å—Ç–µ–º–∞ —É—Ä–æ–≤–Ω–µ–π –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

```python
KASIK_LEVELS = {
    1: {"min_bets": 0, "min_coins": 0, "name": "–ù–æ–≤–∏—á–æ–∫"},
    2: {"min_bets": 10, "min_coins": 100, "name": "–õ—é–±–∏—Ç–µ–ª—å"},
    3: {"min_bets": 50, "min_coins": 500, "name": "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª"},
    4: {"min_bets": 100, "min_coins": 1000, "name": "–õ–µ–≥–µ–Ω–¥–∞"},
}

def get_kasik_level(user_id: int, db_path: str) -> tuple[int, dict]:
    """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É—Ä–æ–≤–µ–Ω—å –∏–≥—Ä–æ–∫–∞ –≤ –∫–∞–∑–∏–Ω–æ"""
    stats = get_kasik_stats(user_id, db_path)
    
    for level_id in sorted(KASIK_LEVELS.keys(), reverse=True):
        level_info = KASIK_LEVELS[level_id]
        if stats['total_bets'] >= level_info['min_bets']:
            return level_id, level_info
    
    return 1, KASIK_LEVELS[1]
```

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–ß–∞—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ WERTY | Chat-Manager Bot

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ:** GitHub Copilot  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 20.12.2025
